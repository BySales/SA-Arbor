{% extends 'core/base_app.html' %}

{% block content %}
    
    {% if query %}
        <h2 class="mb-4">Resultados da busca por: <span class="text-success">"{{ query }}"</span></h2>

        <div class="mb-5">
            <h4>Solicitações Encontradas ({{ solicitacoes_results|length }})</h4>
            <hr>
            {% for solicitacao in solicitacoes_results %}
                <div class="card mb-3 {% if solicitacao.tipo == 'DENUNCIA' %}card-denuncia{% else %}card-sugestao{% endif %}">
                    <div class="card-header">
                        {{ solicitacao.get_tipo_display }} #{{ solicitacao.id }} - <strong>Status: {{ solicitacao.get_status_display }}</strong>
                    </div>
                    <div class="card-body">
                        <p><strong>Cidadão:</strong> {{ solicitacao.cidadao.username }}</p>
                        <p><strong>Descrição:</strong> {{ solicitacao.descricao|truncatewords:50 }}</p>
                        <a href="{% url 'solicitacao_update' pk=solicitacao.pk %}" class="btn btn-secondary btn-sm">Ver Detalhes</a>
                    </div>
                </div>
            {% empty %}
                <div class="alert alert-light">
                    Nenhum resultado encontrado em Solicitações.
                </div>
            {% endfor %}
        </div>

        <div class="mb-5">
            <h4>Espécies Encontradas ({{ especies_results|length }})</h4>
            <hr>
            {% for especie in especies_results %}
                 <div class="card mb-3">
                    <div class="card-body d-flex justify-content-between align-items-center">
                        <div>
                            <h5>{{ especie.nome_popular }}</h5>
                            <p class="mb-0 text-muted">{{ especie.nome_cientifico|default:"Sem nome científico" }}</p>
                        </div>
                        <a href="{% url 'especie_update' pk=especie.pk %}" class="btn btn-secondary btn-sm">Ver Detalhes</a>
                    </div>
                </div>
            {% empty %}
                <div class="alert alert-light">
                    Nenhum resultado encontrado em Catálogo de Espécies.
                </div>
            {% endfor %}
        </div>

        <div class="mb-5">
            <h4>Equipes Encontradas ({{ equipes_results|length }})</h4>
            <hr>
            {% for equipe in equipes_results %}
                <div class="card mb-3">
                    <div class="card-body d-flex justify-content-between align-items-center">
                        <h5>{{ equipe.nome }}</h5>
                        <a href="{% url 'equipe_update' pk=equipe.pk %}" class="btn btn-secondary btn-sm">Ver Detalhes</a>
                    </div>
                </div>
            {% empty %}
                <div class="alert alert-light">
                    Nenhum resultado encontrado em Equipes.
                </div>
            {% endfor %}
        </div>

    {% else %}
        <h2 class="mb-4">Por favor, digite um termo na barra de busca.</h2>
    {% endif %}

{% endblock %}